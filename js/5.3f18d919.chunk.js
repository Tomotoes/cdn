(this.webpackJsonpweibo=this.webpackJsonpweibo||[]).push([[5],{18:function(e,t,n){"use strict";n.r(t);var a=n(22),r=n.n(a),o=n(32),c=n.n(o),s=n(35),i=n(24),l=n(25),u=n(28),m=n(27),d=n(29),f=n(93),p=n(49),g=n(12),h=function(){var e=Object(f.d)();return r.a.createElement("div",{className:"is-issue-footer"},r.a.createElement("a",{onClick:function(){e.goBack(),setTimeout((function(){window.scrollTo(0,window.positionY),window.isComment=!1}),0)},className:" is-issue-icon is-icon-back wobble-horizontal"},r.a.createElement("svg",{className:"is-icon","aria-hidden":"true"},r.a.createElement("use",{xlinkHref:"#icon-lvsefenkaicankaoxianban-"})),r.a.createElement("span",{className:"is-back-text"},window.WEIBO.returnText)))},v=n(13),E=n(79),b=n(80),w=n.n(b),y=n(82),O=function(){function e(){Object(i.a)(this,e)}return Object(l.a)(e,null,[{key:"save",value:function(t,n){if("function"!==typeof n)localStorage.setItem("".concat(e.namespace,"-").concat(t),JSON.stringify(n));else{var a=e.get(t);localStorage.setItem("".concat(e.namespace,"-").concat(t),JSON.stringify(n(a)))}}},{key:"remove",value:function(t){localStorage.removeItem("".concat(e.namespace,"-").concat(t))}},{key:"get",value:function(t){return JSON.parse(localStorage.getItem("".concat(e.namespace,"-").concat(t)))}},{key:"has",value:function(t){var n=localStorage.getItem("".concat(e.namespace,"-").concat(t));return!!n&&"null"!==n&&null!==n}}]),e}();O.namespace="WEIBO";var N=function(){function e(){Object(i.a)(this,e)}return Object(l.a)(e,null,[{key:"init",value:function(){var t=Object(y.a)(w.a.mark((function t(){var n,a,r;return w.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=new window.AV.Query(e.table),t.prev=1,t.next=4,n.get(e.id);case 4:if(e.Reaction=t.sent,e.reactions=e.Reaction.get(e.column),a=O.get(window.WEIBO.sendQueueKey)){t.next=10;break}return O.save(window.WEIBO.sendQueueKey,{}),t.abrupt("return");case 10:r=Object.keys(a).filter((function(e){return a[e]})),e.done.apply(e,Object(s.a)(r)),t.next=17;break;case 14:t.prev=14,t.t0=t.catch(1),console.error(t.t0);case 17:case"end":return t.stop()}}),t,null,[[1,14]])})));return function(){return t.apply(this,arguments)}}()},{key:"get",value:function(t){return e.reactions&&e.reactions[t]?e.reactions[t]:e.defaultValue}},{key:"like",value:function(t){e.done(t)}},{key:"unlike",value:function(t){!e.reactions||!e.reactions[t]||e.reactions[t]<0||(e.reactions[t]-=1,e.done(t))}},{key:"done",value:function(){for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];e.reactions&&n.length&&(n.forEach((function(t){e.reactions[t]?e.reactions[t]+=1:e.reactions[t]=1})),e.Reaction.set(e.column,e.reactions).save().then((function(){O.save(window.WEIBO.sendQueueKey,(function(e){return n.reduce((function(e,t){return e[t]=0,e}),e)}))})).catch(console.error))}}]),e}();N.reactions=null,N.Reaction=null,N.id=window.LEANCLOUD.id,N.table=window.LEANCLOUD.table,N.column=window.LEANCLOUD.column,N.defaultValue=0;var k=function(e){var t=e.id,n=e.comments,o=Object(f.d)(),c=Object(a.useState)(N.get(t)),s=Object(v.a)(c,2),i=s[0],l=s[1],u=Object(a.useState)(i>0&&O.has(t)),m=Object(v.a)(u,2),d=m[0],p=m[1],g=Object(a.useState)(!1),h=Object(v.a)(g,2),b=h[0],w=h[1];return r.a.createElement("div",{className:"is-issue-footer"},r.a.createElement("a",{onClick:Object(E.debounce)((function(){w(!d),!d&&(p(!0),l(i+1),O.save(window.WEIBO.sendQueueKey,(function(e){return e[t]=1,e})),O.save(t,1),N.like(t))}),window.WEIBO.debounce),className:"is-issue-icon is-issue-reaction ".concat(b?"is-issue-like-animation":""," ").concat(d?"is-issue-liked":"")},r.a.createElement("div",{className:"is-icon-reaction-wrap"},r.a.createElement("svg",{className:"is-icon","aria-hidden":"true"},r.a.createElement("use",{xlinkHref:"#icon-like"}))),r.a.createElement("span",{className:"is-reaction-count"},i)),r.a.createElement("a",{onClick:function(){window.isComment=!0,window.positionY=window.scrollY,o.push("".concat(window.WEIBO.root,"/").concat(t)),setTimeout((function(){window.scrollTo(0,0)}),0)},className:"is-issue-icon is-issue-comment"},r.a.createElement("div",{className:"is-icon-comment-wrap"},r.a.createElement("svg",{className:"is-icon","aria-hidden":"true"},r.a.createElement("use",{xlinkHref:"#icon-comment"}))),r.a.createElement("span",{className:"is-comment-count"},n)))},C=function(e){var t=e.name,n=e.color,a=e.className;return r.a.createElement("span",{className:a,style:{backgroundColor:"#".concat(n),color:Object(g.f)(n)}},t)},j=(n(83),n(84),function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props,t=e.issue,n=e.forwardedRef,a=e.isHome;return r.a.createElement("div",{className:"is-issue",ref:n},r.a.createElement("div",{className:"is-issue-content"},r.a.createElement("div",{className:"is-issue-header"},r.a.createElement("span",{className:"is-issue-username"},window.WEIBO.name),r.a.createElement("span",{className:"is-verified-badge"},r.a.createElement("svg",{className:"is-badge",viewBox:"0 0 512 512",xmlns:"http://www.w3.org/2000/svg"},r.a.createElement("path",{d:"m512 268c0 17.9-4.3 34.5-12.9 49.7s-20.1 27.1-34.6 35.4c.4 2.7.6 6.9.6 12.6 0 27.1-9.1 50.1-27.1 69.1-18.1 19.1-39.9 28.6-65.4 28.6-11.4 0-22.3-2.1-32.6-6.3-8 16.4-19.5 29.6-34.6 39.7-15 10.2-31.5 15.2-49.4 15.2-18.3 0-34.9-4.9-49.7-14.9-14.9-9.9-26.3-23.2-34.3-40-10.3 4.2-21.1 6.3-32.6 6.3-25.5 0-47.4-9.5-65.7-28.6-18.3-19-27.4-42.1-27.4-69.1 0-3 .4-7.2 1.1-12.6-14.5-8.4-26-20.2-34.6-35.4-8.5-15.2-12.8-31.8-12.8-49.7 0-19 4.8-36.5 14.3-52.3s22.3-27.5 38.3-35.1c-4.2-11.4-6.3-22.9-6.3-34.3 0-27 9.1-50.1 27.4-69.1s40.2-28.6 65.7-28.6c11.4 0 22.3 2.1 32.6 6.3 8-16.4 19.5-29.6 34.6-39.7 15-10.1 31.5-15.2 49.4-15.2s34.4 5.1 49.4 15.1c15 10.1 26.6 23.3 34.6 39.7 10.3-4.2 21.1-6.3 32.6-6.3 25.5 0 47.3 9.5 65.4 28.6s27.1 42.1 27.1 69.1c0 12.6-1.9 24-5.7 34.3 16 7.6 28.8 19.3 38.3 35.1 9.5 15.9 14.3 33.4 14.3 52.4zm-266.9 77.1 105.7-158.3c2.7-4.2 3.5-8.8 2.6-13.7-1-4.9-3.5-8.8-7.7-11.4-4.2-2.7-8.8-3.6-13.7-2.9-5 .8-9 3.2-12 7.4l-93.1 140-42.9-42.8c-3.8-3.8-8.2-5.6-13.1-5.4-5 .2-9.3 2-13.1 5.4-3.4 3.4-5.1 7.7-5.1 12.9 0 5.1 1.7 9.4 5.1 12.9l58.9 58.9 2.9 2.3c3.4 2.3 6.9 3.4 10.3 3.4 6.7-.1 11.8-2.9 15.2-8.7z",fill:"#1da1f2"}))),r.a.createElement("span",{className:"is-issue-text"},"\xb7"),r.a.createElement("span",{className:"is-issue-date"},Object(g.c)(t.createdAt)),r.a.createElement(C,{className:"is-issue-label",name:t.label.name,color:t.label.color})),r.a.createElement("div",{className:"is-issue-body markdown-body",dangerouslySetInnerHTML:{__html:t.bodyHTML}}),a?r.a.createElement(k,{id:t.number,comments:t.comments}):r.a.createElement(h,null)))}}]),t}(a.PureComponent)),M=function(){var e=window.WEIBO.egg,t=e.text1,n=e.text2,a=e.button,o=e.tip1,c=e.tip2;return r.a.createElement("div",{className:"is-issue-end"},r.a.createElement("h1",{className:"is-end-text"},t),r.a.createElement("h1",{className:"is-end-text"},n),r.a.createElement("button",{className:"is-end-button",onClick:function(){var e=document.createElement("script");document.body.appendChild(e),e.src="//hi.kickassapp.com/kickass.js",alert(o),alert(c)}},r.a.createElement("h1",{className:"is-end-button-text"},a)))},I=(n(85),function(e){return null===e.cursor&&delete e.cursor,{operationName:"getIssues",query:"\n  query getIssues($owner: String!, $repo: String!, $cursor: String, $pageSize: Int!) {\n    repository(owner: $owner, name: $repo) {\n      issues(first: $pageSize, after: $cursor, orderBy: {field: CREATED_AT, direction: DESC}, filterBy: {createdBy: $owner, states: OPEN}) {\n        pageInfo {\n          hasNextPage\n          endCursor\n        }\n        nodes {\n          id\n          number\n          createdAt\n          bodyHTML\n          comments(first: 1) {\n            totalCount\n          }\n          labels(first: 1) {\n            nodes {\n              name\n              color\n            }\n          }\n        }\n      }\n    }\n  }\n  ",variables:e}}),x=function(e,t){return{operationName:"AddComment",query:'\n  mutation AddComment {\n    addComment(input: {subjectId: "'.concat(e,'", body: "').concat(t,'"}) {\n      commentEdge {\n        node {\n          id\n          databaseId\n          author {\n            avatarUrl\n            login\n          }\n          bodyHTML\n          body\n          createdAt\n          reactions(first: 100, content: HEART) {\n            totalCount\n            pageInfo {\n              hasNextPage\n            }\n            nodes {\n              user {\n                login\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n    \n  ')}},L=function(e,t){return{operationName:"UpdateIssueComment",query:'\n  mutation UpdateIssueComment {\n    updateIssueComment(input: {id: "'.concat(e,'", body: "').concat(t,'"}) {\n      issueComment {\n        id\n        databaseId\n        author {\n          avatarUrl\n          login\n        }\n        bodyHTML\n        body\n        createdAt\n        reactions(first: 100, content: HEART) {\n          totalCount\n          pageInfo {\n            hasNextPage\n          }\n          nodes {\n            user {\n              login\n            }\n          }\n        }\n      }\n    }\n  }\n  ')}},S=function(e){return{operationName:"RemoveReaction",query:'\n  mutation RemoveReaction {\n    removeReaction(input: {subjectId: "'.concat(e,'", content: HEART}) {\n      reaction {\n        content\n      }\n    }\n  }\n  ')}},T=function(e){return{operationName:"AddReaction",query:'\n  mutation AddReaction {\n    addReaction(input: {subjectId: "'.concat(e,'", content: HEART}) {\n      reaction {\n        user {\n          login\n        }\n      }\n    }\n  }\n  ')}},A=n(30),P=function(){function e(){Object(i.a)(this,e)}return Object(l.a)(e,null,[{key:"save",value:function(t,n){if(!e.compatible)return null;sessionStorage.setItem("WEIBO-".concat(t),JSON.stringify(n))}},{key:"remove",value:function(t){if(!e.compatible)return null;sessionStorage.removeItem("WEIBO-".concat(t))}},{key:"get",value:function(t){return e.compatible?JSON.parse(sessionStorage.getItem("WEIBO-".concat(t))):null}},{key:"has",value:function(t){if(!e.compatible)return null;var n=sessionStorage.getItem("WEIBO-".concat(t));return!!n&&"null"!==n&&null!==n}}]),e}();P.compatible=!!window.sessionStorage;var z=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(u.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={labels:null},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;if(n.e(7).then(n.bind(null,92)),P.has("labels")){var t=P.get("labels");this.setState({labels:t})}else{var a,r=window.WEIBO,o=r.owner,c=r.repo;A.e.post("/graphql",(a={owner:o,repo:c},{operationName:"getLabels",query:"\n  query getLabels($owner: String!, $repo: String!) {\n    repository(owner: $owner, name: $repo) {\n      labels(first:100){\n        nodes {\n          name\n          color\n        }\n      }\n    }\n  }\n  ",variables:a})).then((function(t){var n=t.data.data.repository.labels.nodes;e.setState({labels:n}),P.save("labels",n)}))}}},{key:"render",value:function(){var e=this.state.labels;return r.a.createElement("div",{className:"about-container collapse"},r.a.createElement("p",{className:"about-title"},"Details & Summary"),r.a.createElement("details",null,r.a.createElement("summary",null,r.a.createElement("span",{role:"img","aria-label":"about-weibo"},"\ud83c\udf89"),"\u5173\u4e8e\u5fae\u535a"),r.a.createElement("div",{className:"details-wrapper"},r.a.createElement("div",{className:"details-styling"},r.a.createElement("p",null,"\u5728\u5927\u4e00\u7684\u65f6\u5019\uff0c\u6211\u5c31\u5173\u6389\u4e86\u81ea\u5df1\u7684\u6240\u6709\u52a8\u6001\u3002"),r.a.createElement("p",null,"\u6211\u4ece\u6765\u6ca1\u6709\u53d1\u8fc7",r.a.createElement("del",null,"\u670b\u53cb\u5708"),"\uff0c\u65b0\u6d6a\u5fae\u535a\u7b49\u56fd\u5185\u5e73\u53f0\u3002"),r.a.createElement("p",null,"\u6211\u4e0d\u60f3\u81ea\u5df1\u7684\u58f0\u97f3\u88ab\u76d1\u7ba1\uff0c\u81ea\u5df1\u7684\u6570\u636e\u88ab\u638c\u63a7\uff0c\u81ea\u5df1\u7684\u884c\u4e3a\u88ab\u5206\u6790\u3002"),r.a.createElement("p",null,"\u6211\u4e0d\u60f3\u6210\u4e3a\u4e00\u4e2a\u5de5\u5177\u3002"),r.a.createElement("p",null,"\u6211\u4e00\u76f4\u5728\u5bfb\u627e\u4e00\u4e2a\u6ca1\u6709\u4efb\u4f55\u6742\u8d28\u7684\u5730\u65b9\u3002"),r.a.createElement("p",null,"\u5b83\u53ef\u80fd\u662f\u4e00\u4e2a\u60c5\u611f\u6811\u6d1e\uff0c\u4e00\u4e2a\u6280\u672f\u793e\u533a\uff0c\u4e00\u4e2a\u968f\u65f6\u5206\u4eab\u60f3\u6cd5\u7684\u5e73\u53f0\u3002"),r.a.createElement("p",null,"\u4f60\u773c\u524d\u6240\u770b\u5230\u7684\u5fae\u535a\uff0c\u6b63\u662f\u6211\u8fd9\u4e00\u5f3a\u70c8\u9700\u6c42\u7684\u4ea7\u7269\u3002"),r.a.createElement("p",null,"\u5b83\u5bf9\u6211\u610f\u4e49\u91cd\u5927\u3002")))),r.a.createElement("details",null,r.a.createElement("summary",null,r.a.createElement("span",{role:"img","aria-label":"about-content"},"\u2728\u5173\u4e8e\u5185\u5bb9")),r.a.createElement("div",{className:"details-wrapper"},r.a.createElement("div",{className:"details-styling"},r.a.createElement("p",null,"\u76ee\u524d\uff0c\u5fae\u535a\u5171\u6709",Array.isArray(e)?e.length:14,"\u4e2a\u5206\u7c7b\uff0c\u5177\u4f53\u5982\u4e0b\uff1a"),r.a.createElement("div",null,Array.isArray(e)&&e.map((function(e,t){var n=e.name,a=e.color;return r.a.createElement(C,{className:"labels-label",name:n,color:a,key:t})})))))),r.a.createElement("details",null,r.a.createElement("summary",null,r.a.createElement("span",{role:"img","aria-label":"about-subscription"},"\ud83d\udd0a\u5173\u4e8e\u8ba2\u9605")),r.a.createElement("div",{className:"details-wrapper"},r.a.createElement("div",{className:"details-styling"},r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement("code",null,"Watch"),"\xa0",r.a.createElement("a",{href:"https://github.com/Tomotoes/weibo",target:"_blank",rel:"noopener noreferrer"},"\u6211\u7684\u5fae\u535a\u4ed3\u5e93")),r.a.createElement("li",null,r.a.createElement("code",null,"Join"),"\xa0",r.a.createElement("a",{href:"https://t.me/tomotoes",target:"_blank",rel:"noopener noreferrer"},"\u6211\u7684 TG \u9891\u9053")),r.a.createElement("li",null,r.a.createElement("code",null,"Subscribe"),"\xa0",r.a.createElement("a",{href:"https://rsshub.app/github/issue/Tomotoes/weibo",target:"_blank",rel:"noopener noreferrer"},"\u6211\u7684 RSS \u6e90")))))))}}]),t}(a.PureComponent),B=function(e){var t=e.issues,n=e.isHome,a=e.isLoading,o=e.hasNextPage,c=e.anchor,s=e.isOccurError,i=e.errorMsg,l=window.WEIBO,u=l.animation,m=l.loading;return r.a.createElement("div",{className:"is-container"},t.length>0&&n&&r.a.createElement(z,null),t.length>0&&r.a.createElement("div",{className:"is-issues",key:"issues"},r.a.createElement(p.a,u,t.map((function(e,a){return r.a.createElement(j,Object.assign({issue:e,key:a,isHome:n},a+1===t.length&&{forwardedRef:c}))})))),a&&r.a.createElement("div",{className:"is-initing"},r.a.createElement("span",{className:"square-loader"},r.a.createElement("span",{className:"square-inner"})),r.a.createElement("p",{className:"is-initing-text"},m)),s&&r.a.createElement("div",{className:"is-error"}," ",i," "),!o&&window.WEIBO.egg.enable&&r.a.createElement(M,null))},R=n(91),_=n(86),H=n.n(_),U=(n(87),n(88),function(e){var t=e.src,n=e.className,a=e.alt;return r.a.createElement("div",{className:"gt-avatar ".concat(n)},r.a.createElement("img",{src:t,alt:"@".concat(a)}))}),W=n(26),q=function(e){var t=e.onClick,n=window.COMMENT.loadMore,a=n.loading,o=n.success,c=n.text;return r.a.createElement(W.AwesomeButtonProgress,{type:"secondary",size:"medium",loadingLabel:a,resultLabel:o,action:function(e,n){t(n)}},c)},$=function(e){var t=e.onClick,n=window.COMMENT.login,a=n.loading,o=n.success,c=n.text;return r.a.createElement(W.AwesomeButtonProgress,{type:"secondary",size:"large",loadingLabel:a,resultLabel:o,action:function(e,n){t(n)}},c)},D=function(e){var t=e.onClick,n=e.disabled,a=window.COMMENT.preview,o=a.loading,c=a.success,s=a.text;return n?r.a.createElement(W.AwesomeButton,{type:"secondary",size:"small"}," ",s," "):r.a.createElement(W.AwesomeButtonProgress,{type:"secondary",size:"small",disabled:n,loadingLabel:o,resultLabel:c,action:function(e,n){t(n)}},s)},J=function(e){var t=e.onClick;return r.a.createElement(W.AwesomeButton,{type:"secondary",size:"small",action:function(e,n){t(n)}},window.COMMENT.edit)},V=function(e){var t=e.onClick,n=e.disabled,a=window.COMMENT.comment,o=a.loading,c=a.success,s=a.text;return n?r.a.createElement(W.AwesomeButton,{type:"secondary",size:"medium"}," ",s," "):r.a.createElement(W.AwesomeButtonProgress,{type:"secondary",size:"medium",disabled:n,loadingLabel:o,resultLabel:c,action:function(e,n){t(n)}},s)},Q=function(e){var t=e.onClick,n=e.disabled,a=window.COMMENT.update,o=a.loading,c=a.success,s=a.text;return n?r.a.createElement(W.AwesomeButton,{type:"secondary",size:"medium"}," ",s," "):r.a.createElement(W.AwesomeButtonProgress,{type:"secondary",size:"medium",loadingLabel:o,resultLabel:c,action:function(e,n){t(n)}},s)},Y=function(e){var t=e.onClick;return r.a.createElement(W.AwesomeButton,{type:"secondary",size:"small",action:function(e,n){t(n)}},window.COMMENT.update.cancel)};function K(){return(K=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function F(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var G=r.a.createElement("path",{d:"M785.333333 85.333333C774.666667 85.333333 763.2 90.133333 754.666667 98.666667L682.666667 170.666667 853.333333 341.333333 925.333333 269.333333C942.4 252.266667 942.4 222.133333 925.333333 209.333333L814.666667 98.666667C806.133333 90.133333 796 85.333333 785.333333 85.333333zM640 217.333333 85.333333 768 85.333333 938.666667 256 938.666667 806.666667 384 640 217.333333z"}),X=function(e){var t=e.svgRef,n=e.title,a=F(e,["svgRef","title"]);return r.a.createElement("svg",K({viewBox:"0 0 1024 1024",ref:t},a),n?r.a.createElement("title",null,n):null,G)},Z=r.a.forwardRef((function(e,t){return r.a.createElement(X,K({svgRef:t},e))}));n.p;function ee(){return(ee=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function te(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var ne=r.a.createElement("path",{d:"M64 524C64 719.602 189.356 885.926 364.113 947.017 387.65799 953 384 936.115 384 924.767L384 847.107C248.118 863.007 242.674 773.052 233.5 758.001 215 726.501 171.5 718.501 184.5 703.501 215.5 687.501 247 707.501 283.5 761.501 309.956 800.642 361.366 794.075 387.658 787.497 393.403 763.997 405.637 743.042 422.353 726.638 281.774 701.609 223 615.67 223 513.5 223 464.053 239.322 418.406 271.465 381.627 251.142 320.928 273.421 269.19 276.337 261.415 334.458 256.131 394.888 302.993 399.549 306.685 432.663 297.835 470.341 293 512.5 293 554.924 293 592.81 297.896 626.075 306.853 637.426 298.219 693.46 258.054 747.5 262.966 750.382 270.652 772.185 321.292 753.058 381.083 785.516 417.956 802 463.809 802 513.5 802 615.874 742.99 701.953 601.803 726.786 625.381 750.003 640 782.295 640 818.008L640 930.653C640.752 939.626 640 948.664978 655.086 948.665 832.344 888.962 960 721.389 960 524 960 276.576 759.424 76 512 76 264.577 76 64 276.576 64 524Z"}),ae=function(e){var t=e.svgRef,n=e.title,a=te(e,["svgRef","title"]);return r.a.createElement("svg",ee({viewBox:"0 0 1024 1024",ref:t},a),n?r.a.createElement("title",null,n):null,ne)},re=r.a.forwardRef((function(e,t){return r.a.createElement(ae,ee({svgRef:t},e))}));n.p;function oe(){return(oe=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function ce(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var se=r.a.createElement("path",{d:"M527.061333 166.528A277.333333 277.333333 0 0 1 1000.618667 362.666667a277.333333 277.333333 0 0 1-81.28 196.138666l-377.173334 377.173334a42.666667 42.666667 0 0 1-60.330666 0l-377.173334-377.173334a277.376 277.376 0 0 1 392.277334-392.277333l15.061333 15.061333 15.061333-15.061333z"}),ie=function(e){var t=e.svgRef,n=e.title,a=ce(e,["svgRef","title"]);return r.a.createElement("svg",oe({t:1512463363724,viewBox:"0 0 1024 1024",ref:t},a),n?r.a.createElement("title",null,n):null,se)},le=r.a.forwardRef((function(e,t){return r.a.createElement(ie,oe({svgRef:t},e))}));n.p;function ue(){return(ue=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function me(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var de=r.a.createElement("path",{d:"M527.061333 166.528A277.333333 277.333333 0 0 1 1000.618667 362.666667a277.333333 277.333333 0 0 1-81.28 196.138666l-377.173334 377.173334a42.666667 42.666667 0 0 1-60.330666 0l-377.173334-377.173334a277.376 277.376 0 0 1 392.277334-392.277333l15.061333 15.061333 15.061333-15.061333z m286.72 377.173333l45.226667-45.226666a192 192 0 0 0-135.808-327.893334 192 192 0 0 0-135.808 56.32l-45.226667 45.226667a42.666667 42.666667 0 0 1-60.330666 0l-45.226667-45.226667a192.042667 192.042667 0 0 0-271.616 271.573334L512 845.482667l301.781333-301.781334z"}),fe=function(e){var t=e.svgRef,n=e.title,a=me(e,["svgRef","title"]);return r.a.createElement("svg",ue({viewBox:"0 0 1024 1024",ref:t},a),n?r.a.createElement("title",null,n):null,de)},pe=r.a.forwardRef((function(e,t){return r.a.createElement(fe,ue({svgRef:t},e))}));n.p;function ge(){return(ge=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function he(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var ve=r.a.createElement("path",{d:"M529.066665 273.066666 529.066665 0 51.2 477.866666 529.066665 955.733335 529.066665 675.84C870.4 675.84 1109.333335 785.066665 1280 1024 1211.733335 682.666665 1006.933335 341.333334 529.066665 273.066666"}),Ee=function(e){var t=e.svgRef,n=e.title,a=he(e,["svgRef","title"]);return r.a.createElement("svg",ge({viewBox:"0 0 1332 1024",ref:t},a),n?r.a.createElement("title",null,n):null,ve)},be=r.a.forwardRef((function(e,t){return r.a.createElement(Ee,ge({svgRef:t},e))}));n.p;function we(){return(we=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function ye(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var Oe=r.a.createElement("path",{d:"M512 366.949535c-16.065554 0-29.982212 13.405016-29.982212 29.879884l0 359.070251c0 16.167882 13.405016 29.879884 29.982212 29.879884 15.963226 0 29.879884-13.405016 29.879884-29.879884L541.879884 396.829419C541.879884 380.763865 528.474868 366.949535 512 366.949535L512 366.949535z","p-id":3083}),Ne=r.a.createElement("path",{d:"M482.017788 287.645048c0-7.776956 3.274508-15.553912 8.80024-21.181973 5.525732-5.525732 13.302688-8.80024 21.181973-8.80024 7.776956 0 15.553912 3.274508 21.079644 8.80024 5.525732 5.62806 8.80024 13.405016 8.80024 21.181973 0 7.776956-3.274508 15.656241-8.80024 21.181973-5.525732 5.525732-13.405016 8.697911-21.079644 8.697911-7.879285 0-15.656241-3.274508-21.181973-8.697911C485.292295 303.301289 482.017788 295.524333 482.017788 287.645048L482.017788 287.645048z","p-id":3084}),ke=r.a.createElement("path",{d:"M512 946.844409c-239.8577 0-434.895573-195.037873-434.895573-434.895573 0-239.8577 195.037873-434.895573 434.895573-434.895573 239.755371 0 434.895573 195.037873 434.895573 434.895573C946.895573 751.806535 751.755371 946.844409 512 946.844409zM512 126.17088c-212.740682 0-385.880284 173.037274-385.880284 385.777955 0 212.740682 173.037274 385.777955 385.880284 385.777955 212.740682 0 385.777955-173.037274 385.777955-385.777955C897.777955 299.208154 724.740682 126.17088 512 126.17088z","p-id":3085}),Ce=function(e){var t=e.svgRef,n=e.title,a=ye(e,["svgRef","title"]);return r.a.createElement("svg",we({viewBox:"0 0 1024 1024",ref:t},a),n?r.a.createElement("title",null,n):null,Oe,Ne,ke)},je=r.a.forwardRef((function(e,t){return r.a.createElement(Ce,we({svgRef:t},e))})),Me=(n.p,function(e){var t=e.className,n=e.text,a=e.name;return r.a.createElement("span",{className:"gt-ico ".concat(t)},r.a.createElement("span",{className:"gt-svg"},function(e){return"edit"===e?r.a.createElement(Z,null):"github"===e?r.a.createElement(re,null):"heart_on"===e?r.a.createElement(le,null):"heart"===e?r.a.createElement(pe,null):"reply"===e?r.a.createElement(be,null):"tip"===e?r.a.createElement(je,null):void 0}(a)),r.a.createElement("span",{className:"gt-ico-text"},n))}),Ie=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(u.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={liked:!1,count:0},n.toggleLike=function(){if(n.props.currentUser){var e=n.state,t=e.count,a=e.liked,r=n.props,o=r.unlike,c=r.like;"100+"!==t&&(t+=a?-1:1),n.setState({count:t,liked:!a}),a?o():c()}},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.reactions,n=e.currentUser,a=t.totalCount,r=n&&t.nodes.some((function(e){return e.user.login===n}));100===a&&t.pageInfo&&t.pageInfo.hasNextPage&&(a="100+"),this.setState({count:a,liked:r})}},{key:"render",value:function(){var e=this.state,t=e.count,n=e.liked;return r.a.createElement("a",{className:"gt-comment-like",title:"\u559c\u6b22",onClick:this.toggleLike},n?r.a.createElement(Me,{className:"gt-ico-heart",name:"heart_on",text:t}):r.a.createElement(Me,{className:"gt-ico-heart",name:"heart",text:t}))}}]),t}(a.PureComponent),xe=function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this.node,t=e.querySelector(".email-hidden-toggle>a");t&&t.addEventListener("click",(function(t){t.preventDefault(),e.querySelector(".email-hidden-reply").classList.toggle("expanded")}),!0)}},{key:"render",value:function(){var e=this,t=this.props,n=t.comment,a=t.user,o=t.reply,c=t.unlike,s=t.like,i=t.edit,l=!1;a&&(l=a.login);var u=n.user.login,m=l&&u===l,d=window.COMMENT.admin.some((function(e){return e===u}));return r.a.createElement("div",{ref:function(t){e.node=t},className:"gt-comment ".concat(d?"gt-comment-admin":"")},r.a.createElement(U,{className:"gt-comment-avatar",src:n.user&&n.user.avatar,alt:n.user&&n.user.login}),r.a.createElement("div",{className:"gt-comment-content"},r.a.createElement("div",{className:"gt-comment-header"},r.a.createElement("div",{className:"gt-comment-block-".concat(a?"2":"1")}),r.a.createElement("a",{className:"gt-comment-username",href:n.user&&"https://github.com/".concat(n.user.login),target:"_blank",rel:"noopener noreferrer"},n.user&&n.user.login),r.a.createElement("span",{className:"gt-comment-text"},window.COMMENT.commented),r.a.createElement("span",{className:"gt-comment-date"},Object(g.c)(n.createdAt)),r.a.createElement(Ie,{like:s,unlike:c,currentUser:l,reactions:n.reactions}),l&&(m?r.a.createElement("a",{className:"gt-comment-edit",title:"\u7f16\u8f91",onClick:i},r.a.createElement(Me,{className:"gt-ico-edit",name:"edit"})):r.a.createElement("a",{className:"gt-comment-reply",title:"\u56de\u590d",onClick:o},r.a.createElement(Me,{className:"gt-ico-reply",name:"reply"})))),r.a.createElement("div",{className:"gt-comment-body markdown-body",dangerouslySetInnerHTML:{__html:n.bodyHtml}})))}}]),t}(a.PureComponent),Le=function(e){var t={width:window.COMMENT.width,height:window.COMMENT.height};t.left=Math.floor(window.screenX+(window.outerWidth-t.width)/2),t.top=Math.floor(window.screenY+(window.outerHeight-t.height)/3);var n=-1!==e.indexOf("?")?"&":"?",a="".concat(e).concat(n),r="toolbar=0,scrollbars=1,status=1,resizable=1,location=1,menuBar=0,\n    width=".concat(t.width,",height=").concat(t.height,",\n    left=").concat(t.left,",top=").concat(t.top),o=window.open(a,"Weibo OAuth Application",r),c=window.addEventListener?"addEventListener":"attachEvent",s=window[c],i="attachEvent"===c?"onmessage":"message";return new Promise((function(e,t){s(i,(function(n){return function(e,t,n){if(o.close(),e.origin!==window.COMMENT.domain&&n("Not allowed"),"string"===typeof e.data){var a=JSON.parse(e.data).token;a||n("Unauthorised"),t(a)}}(n,e,t)}),!1)}))},Se=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(u.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={user:null,comments:[],comment:"",page:1,hasNextPage:!1,cursor:null,issueUrl:Object(g.h)(n.props.number),commentUrl:Object(g.g)(n.props.number),isIniting:!0,isUpdating:!1,uId:0,isPreview:!1,previewHtml:"",isOccurError:!1,errorMsg:""},n.createComment=function(e){if(n.state.comment.length){var t=n.state,a=t.comment,r=t.comments,o=t.hasNextPage,c=n.props,s=c.addComments,i=c.number,l=c.gId;Object(A.c)(n.accessToken).post("/graphql",x(l,a)).then((function(e){if(o&&r.length)n.setState({comment:""});else{var t=Object(g.a)(e.data.data.addComment.commentEdge.node);r.push(t),n.setState({comment:"",comments:r})}s(i)})).then(e).catch((function(t){e(!1,window.COMMENT.comment.fail),n.handleError(t)}))}else n.commentEL.focus()},n.updateComment=function(e){if(n.state.comment.length){var t=n.state,a=t.comment,r=t.comments,o=t.uId;Object(A.c)(n.accessToken).post("/graphql",L(o,a)).then((function(t){var a=Object(g.a)(t.data.data.updateIssueComment.issueComment);n.setState({comment:"",comments:r.map((function(e){return e.gId===o?a:e})),isUpdating:!1},e)})).catch((function(t){e(!1,window.COMMENT.update.fail)}))}else n.commentEL.focus()},n.previewComment=function(e){n.setState({isPreview:!0,previewHtml:window.COMMENT.preview.html},(function(){A.b.post("/markdown",{text:n.state.comment},{headers:n.accessToken&&{Authorization:"token ".concat(n.accessToken)}}).then((function(t){n.setState({previewHtml:t.data},e)})).catch((function(t){n.handleError(t,{}),e(!1,window.COMMENT.preview.fail)}))}))},n.getMoreComments=function(e){n.getComments().then(e).catch((function(){return e(!1,window.COMMENT.loadFail)}))},n.like=function(e){Object(A.c)(n.accessToken).post("/graphql",T(e.gId))},n.unlike=function(e){Object(A.c)(n.accessToken).post("/graphql",S(e.gId))},n.login=function(e){var t={client_id:window.COMMENT.clientID,redirect_uri:window.location.href,scope:"public_repo"},a="".concat("https://github.com/login/oauth/authorize","?").concat(Object(g.j)(t));Le(a).then((function(t){n.accessToken=t,n.getUserInfo().then(e).catch((function(t){e(!1,window.COMMENT.login.fail),n.handleError(t)}))})).catch((function(t){e(!1,window.COMMENT.login.fail),n.handleError(t)}))},n.logout=function(){n.setState({user:null}),O.remove("token"),P.remove("user")},n.handleError=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{isIniting:!1};console.log("err:",e),n.setState(Object(R.a)({},t,{isOccurError:!0,errorMsg:Object(g.e)(e)}))},n.reply=function(e){return function(){var t=n.state.comment,a=e.body.split("\n");a.unshift("@".concat(e.user.login)),(a=a.map((function(e){return"> ".concat(e)}))).push(""),a.push(""),t&&a.unshift(""),n.setState({comment:t+a.join("\n")},(function(){H.a.update(n.commentEL),n.commentEL.focus()}))}},n.edit=function(e){return function(){n.setState({comment:e.body,isUpdating:!0,uId:e.gId},(function(){H.a.update(n.commentEL),n.commentEL.focus()}))}},n.changeComment=function(e){return n.setState({comment:e.target.value})},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidUpdate",value:function(){this.commentEL&&H()(this.commentEL)}},{key:"componentDidMount",value:function(){var e=this;this.init().then((function(){return e.setState({isIniting:!1})})).catch(this.handleError)}},{key:"init",value:function(){return 0===this.props.comments?this.accessToken?this.getUserInfo():Promise.resolve():this.accessToken?Promise.all([this.getComments(),this.getUserInfo()]):this.getComments()}},{key:"getComments",value:function(){var e,t=this,n=window.COMMENT,a=n.owner,r=n.repo,o=n.pageSize,c=this.state,i=c.cursor,l=c.comments,u=this.props.number;return A.a.post("/graphql",(e={owner:a,repo:r,id:u,pageSize:o,cursor:i},null===e.cursor&&delete e.cursor,{operationName:"getIssueAndComments",query:"\n  query getIssueAndComments($owner: String!, $repo: String!, $id: Int!, $cursor: String, $pageSize: Int!) {\n    repository(owner: $owner, name: $repo) {\n      issue(number: $id) {\n        comments(first: $pageSize, after: $cursor) {\n          pageInfo {\n            hasNextPage\n            endCursor\n          }\n          nodes {\n            id\n            databaseId\n            author {\n              avatarUrl\n              login\n            }\n            bodyHTML\n            body\n            createdAt\n            reactions(first: 100, content: HEART) {\n              totalCount\n              pageInfo {\n                hasNextPage\n              }\n              nodes {\n                user {\n                  login\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }  \n  ",variables:e})).then((function(e){var n=e.data.data.repository.issue.comments,a=n.pageInfo,r=a.hasNextPage,o=a.endCursor;l.push.apply(l,Object(s.a)(Object(g.b)(n.nodes))),t.setState({comments:l,hasNextPage:r,cursor:o})})).catch(this.handleError)}},{key:"getUserInfo",value:function(){var e=this;if(P.has("user")){var t=P.get("user");return Promise.resolve(this.setState({user:t}))}return A.b.get("/user",{headers:{Authorization:"token ".concat(this.accessToken)}}).then((function(t){var n=t.data,a={login:n.login,avatar:n.avatar_url};e.setState({user:a}),P.save("user",a)})).catch(this.logout)}},{key:"initing",value:function(){return r.a.createElement("div",{className:"gt-initing"},r.a.createElement("span",{className:"square-loader"},r.a.createElement("span",{className:"square-inner"})),r.a.createElement("p",{className:"is-initing-text"},window.COMMENT.initText))}},{key:"meta",value:function(){var e=this.state,t=e.user,n=e.issueUrl,a=this.props.comments;return r.a.createElement("div",{className:"gt-meta",key:"meta"},r.a.createElement("span",{className:"gt-counts"},r.a.createElement("a",{className:"gt-link gt-link-counts",href:n,rel:"noopener noreferrer",target:"_blank"},a," "),window.COMMENT.counts),r.a.createElement("div",{className:"gt-user"},t&&r.a.createElement("div",{className:"gt-user-inner"},r.a.createElement("span",{className:"gt-user-name"},t.login,"\xa0|\xa0"),r.a.createElement("a",{className:"gt-action gt-action-logout",onClick:this.logout},r.a.createElement("span",{className:"gt-action-text"},window.COMMENT.logout)),"\xa0")))}},{key:"header",value:function(){var e=this,t=this.state,n=t.user,a=t.comment,o=t.previewHtml,c=t.isPreview,s=t.isUpdating;return r.a.createElement("div",{className:"gt-header",key:"header"},n?r.a.createElement(U,{className:"gt-header-avatar",src:n.avatar,alt:n.login}):r.a.createElement("a",{className:"gt-avatar-github",onClick:this.login},r.a.createElement(Me,{className:"gt-ico-github",name:"github"})),r.a.createElement("div",{className:"gt-header-comment"},r.a.createElement("textarea",{ref:function(t){e.commentEL=t},className:"gt-header-textarea ".concat(c?"hide":""),value:a,onChange:this.changeComment,placeholder:window.COMMENT.placeholder}),r.a.createElement("div",{className:"gt-header-preview markdown-body ".concat(c?"":"hide"),dangerouslySetInnerHTML:{__html:o}}),r.a.createElement("div",{className:"gt-header-controls"},r.a.createElement("a",{className:"gt-header-controls-tip",href:"https://guides.github.com/features/mastering-markdown/",rel:"noopener noreferrer",target:"_blank"},r.a.createElement(Me,{className:"gt-ico-tip",name:"tip",text:window.COMMENT.supportMD})),n&&(s?r.a.createElement(Q,{disabled:0===a.length,onClick:this.updateComment}):r.a.createElement(V,{disabled:0===a.length,onClick:this.createComment})),s?r.a.createElement(Y,{onClick:function(t){return e.setState({isUpdating:!1,comment:""},t)}}):c?r.a.createElement(J,{onClick:function(t){return e.setState({isPreview:!1},t)}}):r.a.createElement(D,{disabled:0===a.length,onClick:this.previewComment}),!n&&r.a.createElement($,{onClick:this.login}))))}},{key:"comments",value:function(){var e=this,t=this.state,n=t.user,a=t.comments,o=t.hasNextPage,c=window.COMMENT.flipMoveOptions;return r.a.createElement("div",{className:"gt-comments",key:"comments"},r.a.createElement(p.a,c,a.map((function(t,a){return r.a.createElement(xe,{comment:t,key:a,user:n,reply:e.reply(t),edit:e.edit(t),like:e.like.bind(e,t),unlike:e.unlike.bind(e,t)})}))),!a.length&&r.a.createElement("p",{className:"gt-comments-null"},window.COMMENT.firstCommentText),o&&a.length&&r.a.createElement("div",{className:"gt-comments-controls"},r.a.createElement(q,{onClick:this.getMoreComments})))}},{key:"render",value:function(){var e=this.state,t=e.isIniting,n=e.isOccurError,a=e.errorMsg;return r.a.createElement("div",{className:"gt-container"},t&&this.initing(),!t&&this.meta(),n&&r.a.createElement("div",{className:"gt-error"}," ",a," "),!t&&[this.header(),this.comments()])}},{key:"accessToken",get:function(){return this._accessToken||O.get("token")},set:function(e){O.save("token",e),this._accessToken=e}}]),t}(a.PureComponent),Te=(n(89),function(e){var t=e.issues,n=e.addComments;t&&t.length||(window.location.href=window.WEIBO.root);var a=Object(f.e)().id,o=t.filter((function(e){return e.number==a})),c={issues:o,isLoading:!1,isOccurError:!1,hasNextPage:!0,isHome:!1},s=o[0],i=s.number,l=s.comments,u=s.gId;return r.a.createElement("div",null,r.a.createElement(B,c),r.a.createElement(Se,{number:i,gId:u,comments:l,addComments:n}))}),Ae=(n(33),function(e,t,n){var a,r,o,c=null,s=0;n||(n={});var i=function(){s=!1===n.leading?0:(new Date).getTime(),c=null,o=e.apply(a,r),c||(a=r=null)};return function(){var l=(new Date).getTime();s||!1!==n.leading||(s=l);var u=t-(l-s);return a=this,r=arguments,u<=0||u>t?(c&&(clearTimeout(c),c=null),s=l,o=e.apply(a,r),c||(a=r=null)):c||!1===n.trailing||(c=setTimeout(i,u)),o}}),Pe=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,o=new Array(a),c=0;c<a;c++)o[c]=arguments[c];return(n=Object(u.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(o)))).state={issues:[],cursor:null,isLoading:!0,hasNextPage:!0,isOccurError:!1,errorMsg:"",isHome:!0,anchor:r.a.createRef()},n.fetch=function(){var e=n.state.cursor,t=window.WEIBO,a=t.owner,r=t.repo,o=t.pageSize;return A.e.post("/graphql",I({owner:a,repo:r,cursor:e,pageSize:o}))},n.getIssues=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n.fetch,t=n.state.issues;return e().then((function(e){var a=(e=e.length?e[0]:e).data.data.repository.issues,r=a.pageInfo,o=r.hasNextPage,c=r.endCursor;o||window.removeEventListener("scroll",n.lazyLoad),t.push.apply(t,Object(s.a)(Object(g.d)(a.nodes))),n.setState({hasNextPage:o,cursor:c,issues:t,isLoading:!1,isOccurError:!1}),P.save("state",{hasNextPage:o,cursor:c,issues:t})})).catch(n.handleError)},n.addComments=function(e){var t=n.state,a=t.issues,r=t.cursor,o=t.hasNextPage;a=n.state.issues.map((function(t){return t.comments+=e==t.number,t})),n.setState({issues:a}),P.save("state",{issues:a,cursor:r,hasNextPage:o})},n.lazyLoad=Ae((function(){if(!n.state.isLoading&&!window.isComment){var e=window.innerHeight||document.documentElement.clientHeight;window.scrollY+window.WEIBO.offsetTop*e<n.state.anchor.current.offsetTop||n.setState({isLoading:!0},n.getIssues)}}),window.WEIBO.throttle),n.handleError=function(e){console.error("err:",e),n.setState({isLoading:!1,isOccurError:!0,errorMsg:Object(g.e)(e)})},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;if(P.has("state")){var t=P.get("state"),n=t.issues,a=t.hasNextPage,r=t.cursor;return N.init().then((function(){e.setState({issues:n,hasNextPage:a,cursor:r,isLoading:!1})})),void(a&&window.addEventListener("scroll",this.lazyLoad,!1))}this.getIssues((function(){return Promise.all([e.fetch(),N.init()])})),window.addEventListener("scroll",this.lazyLoad,!1)}},{key:"render",value:function(){return r.a.createElement(f.a,{initialEntries:[window.WEIBO.root]},r.a.createElement(f.c,null,r.a.createElement(f.b,{path:window.WEIBO.root,exact:!0},r.a.createElement(B,Object.assign({},this.state,{getIssues:this.getIssues}))),r.a.createElement(f.b,{path:"".concat(window.WEIBO.root,"/:id")},r.a.createElement(Te,{issues:this.state.issues,addComments:this.addComments}))))}}]),t}(a.PureComponent),ze=n(90),Be=n.n(ze);window.AV=Be.a,Be.a.init(window.LEANCLOUD),c.a.render(r.a.createElement(Pe,null),document.getElementById("weibo-container"))},30:function(e,t,n){"use strict";n.d(t,"e",(function(){return o})),n.d(t,"a",(function(){return c})),n.d(t,"c",(function(){return s})),n.d(t,"d",(function(){return f})),n.d(t,"b",(function(){return p}));var a=n(38),r=n.n(a),o=r.a.create({baseURL:"https://api.github.com/",headers:{Accept:"application/json",Authorization:"bearer ".concat(window.WEIBO.token.join(""))}}),c=r.a.create({baseURL:"https://api.github.com/",headers:{Accept:"application/json",Authorization:"bearer ".concat(window.COMMENT.token.join(""))}}),s=function(e){return e?r.a.create({baseURL:"https://api.github.com/",headers:{Accept:"application/json",Authorization:"bearer ".concat(e)}}):Promise.reject()},i=r.a.create({headers:{Accept:"application/json"}}),l=window.COMMENT,u=l.proxy,m=l.clientID,d=l.clientSecret,f=function(){return i.post(u,{code:window.auth.code,client_id:m,client_secret:d})},p=r.a.create({baseURL:"https://api.github.com",headers:{Accept:"application/json"}})},33:function(e,t,n){},84:function(e,t){!function(e){var t,n='<svg><symbol id="icon-lvsefenkaicankaoxianban-" viewBox="0 0 1024 1024"><path d="M898.133333 597.333333c72.533333-128 42.666667-256-44.8-320-42.666667-32-85.333333-42.666667-151.466666-42.666666h-185.6c-29.866667 0-34.133333 12.8-34.133334 44.8l-2.133333-17.066667c0 32 4.266667 36.266667 34.133333 36.266667h183.466667c36.266667 0 104.533333 14.933333 128 42.666666 44.8 49.066667 51.2 194.133333 10.666667 245.333334-29.866667 38.4-93.866667 46.933333-119.466667 46.933333l-253.866667-2.133333v70.4h264.533334c66.133333-2.133333 134.4-40.533333 170.666666-104.533334zM198.4 680.533333l187.733333-108.8c29.866667-17.066667 66.133333 4.266667 57.6 38.4v217.6c6.4 34.133333-29.866667 55.466667-57.6 38.4l-187.733333-108.8c-29.866667-17.066667-29.866667-59.733333 0-76.8z" fill="#48cc85" ></path><path d="M405.333333 893.866667c-14.933333 0-29.866667-4.266667-42.666666-12.8L76.8 718.933333c-27.733333-14.933333-44.8-44.8-44.8-76.8s17.066667-59.733333 44.8-76.8L362.666667 401.066667c29.866667-17.066667 66.133333-14.933333 91.733333 4.266666 23.466667 17.066667 34.133333 44.8 27.733333 74.666667v324.266667c6.4 29.866667-4.266667 57.6-27.733333 74.666666-17.066667 10.666667-32 14.933333-49.066667 14.933334zM98.133333 603.733333c-14.933333 8.533333-23.466667 23.466667-23.466666 38.4s8.533333 29.866667 23.466666 38.4L384 844.8c14.933333 8.533333 32 8.533333 44.8-2.133333 6.4-4.266667 14.933333-14.933333 10.666667-34.133334V471.466667c4.266667-19.2-6.4-29.866667-10.666667-34.133334-12.8-8.533333-29.866667-10.666667-44.8-2.133333L98.133333 603.733333z" fill="#1E1E1E" ></path><path d="M738.133333 716.8H437.333333v-155.733333h292.266667c21.333333 0 51.2-12.8 64-27.733334 55.466667-68.266667 38.4-138.666667 0-177.066666-23.466667-23.466667-53.333333-36.266667-85.333333-36.266667h-194.133334c-42.666667 0-76.8-34.133333-76.8-76.8s36.266667-78.933333 78.933334-78.933333h198.4c74.666667 0 142.933333 27.733333 196.266666 81.066666 96 96 108.8 236.8 32 362.666667-42.666667 66.133333-119.466667 108.8-204.8 108.8z m-258.133333-42.666667h258.133333c68.266667 0 132.266667-34.133333 166.4-89.6 66.133333-106.666667 55.466667-228.266667-25.6-309.333333-44.8-44.8-102.4-68.266667-166.4-68.266667h-198.4c-19.2 0-36.266667 17.066667-36.266666 36.266667 0 19.2 14.933333 34.133333 34.133333 34.133333h194.133333c42.666667 0 85.333333 17.066667 115.2 49.066667 51.2 51.2 74.666667 147.2 2.133334 234.666667-19.2 25.6-61.866667 44.8-96 44.8H480v68.266666z" fill="#1E1E1E" ></path></symbol><symbol id="icon-like" viewBox="0 0 1024 1024"><path d="M512 284.3230811c-61.06984334-61.06984334-160.10202112-61.06984334-221.26895445 0-77.38102557 77.38102557-77.38102557 202.91887445 0 280.29990002l221.46313557 220.97768221 220.97768221-220.97768221c77.38102557-77.38102557 77.38102557-202.91887445 0-280.29990002-39.61287111-39.61287111-95.05147221-53.49679445-145.82973554-41.84594887" fill="#fe7575" ></path><path d="M868.51584 145.96930333c-66.60399445-66.60399445-161.17001443-93.78929778-253.11459555-72.62359666-20.87443001 4.8545189-33.98163001 25.63185778-29.12711112 46.60337778 4.75742777 20.87443001 25.63185778 33.88453888 46.60337778 29.1271111 65.63308999-15.14609778 133.20798777 4.27197667 180.78227001 51.84625778 99.80890112 99.80890112 99.80890112 262.144 0 361.95290112L512.3883611 863.95259221l-301.95105109-301.17432888c-99.80890112-99.80890112-99.80890112-262.144 0-361.95289999 75.53630777-75.53630777 198.54980779-75.53630777 274.08611556 0l66.99235555 67.38071666c7.67013888 7.76723001 75.14794667 74.17704334 144.66465109 74.17704334 1.74762667 0 3.59234333 0 5.33997113-0.09709113 29.32129223-1.45635555 55.05024-14.85482667 74.17704221-38.64196664a38.74876643 38.74876643 0 0 0-5.92251222-54.56478891 38.83614777 38.83614777 0 0 0-54.56478776 5.92251335c-6.50505443 8.15559111-12.23338667 9.51485667-17.47626667 9.70903666-28.83584 1.65053667-73.69159111-33.78744889-90.9736778-51.16662557l-67.18653553-67.67198777v-0.09708999c-105.82850333-105.82850333-278.06682112-105.82850333-383.99241558 0-130.10109667 130.10109667-130.10109667 341.66101333 0 471.76210887l329.42762667 328.65090446c7.57304889 7.57304889 17.47626667 11.35957333 27.47657557 11.35957334 9.90321778 0 19.90352555-3.78652445 27.47657444-11.35957334l328.65090332-328.65090446c129.90691555-129.90691555 129.90691555-341.56392334-0.09708999-471.56792888z" fill="#333333" ></path><path d="M240.63241443 413.45327445c-21.45697223 0-38.83614777-17.37917667-38.83614776-38.8361489 0-56.99204779 16.31118222-100.87689443 48.54518556-130.58654777 43.10812445-39.61287111 96.6049189-36.40888889 102.52743111-35.92343666 21.3598811 1.74762667 37.28270222 20.5831589 35.53507556 41.94304A38.73905778 38.73905778 0 0 1 346.94636999 285.58525667c-1.26217443 0-26.50567111-0.87381333-44.56448 16.11700111-15.24318777 14.36937443-22.91332779 38.9332389-22.91332665 72.91486777 0 21.3598811-17.37917667 38.83614777-38.83614891 38.8361489z" fill="#333333" ></path></symbol><symbol id="icon-comment" viewBox="0 0 1024 1024"><path d="M722.26133333 387.45429333c0-47.15861333-36.864-85.71562667-81.92-85.71562666H75.09333333v367.57504C75.09333333 716.44501333 111.95733333 755.02933333 157.01333333 755.02933333h81.92v165.25994667a27.77088 27.77088 0 0 0 32.08533334 28.23509333L307.2 910.67733333h3.74101333L391.85066667 826.02666667h3.14026666L462.848 755.02933333h259.41333333z" fill="#a6c4e1" ></path><path d="M861.52533333 162.47466667v505.17333333H425.49248l-25.8048 27.00629333L326.31466667 771.41333333v-103.76533333H162.47466667V162.47466667h699.05066666m5.46133334-87.38133334H157.01333333c-45.056 0-81.92 38.55701333-81.92 85.71562667v508.50474667C75.09333333 716.44501333 111.95733333 755.02933333 157.01333333 755.02933333h81.92v165.25994667A27.93472 27.93472 0 0 0 266.45845333 948.90666667a26.13248 26.13248 0 0 0 19.11466667-8.43776L462.848 755.02933333h404.13866667c45.056 0 81.92-38.55701333 81.92-85.68832V160.80896C948.90666667 113.65034667 912.04266667 75.09333333 866.98666667 75.09333333z" fill="#333333" ></path><path d="M315.392 375.46666667a43.69066667 43.69066667 0 1 0 43.69066667 43.69066666 43.69066667 43.69066667 0 0 0-43.69066667-43.69066666zM708.608 375.46666667a43.69066667 43.69066667 0 1 0 43.69066667 43.69066666 43.69066667 43.69066667 0 0 0-43.69066667-43.69066666zM512 375.46666667a43.69066667 43.69066667 0 1 0 43.69066667 43.69066666 43.69066667 43.69066667 0 0 0-43.69066667-43.69066666z" fill="#333333" ></path></symbol></svg>';if((t=document.getElementsByTagName("script"))[t.length-1].getAttribute("data-injectcss")&&!e.__iconfont__svg__cssinject__){e.__iconfont__svg__cssinject__=!0;try{document.write("<style>.svgfont {display: inline-block;width: 1em;height: 1em;fill: currentColor;vertical-align: -0.1em;font-size:16px;}</style>")}catch(t){console&&console.log(t)}}!function(t){if(document.addEventListener)if(~["complete","loaded","interactive"].indexOf(document.readyState))setTimeout(t,0);else{document.addEventListener("DOMContentLoaded",(function e(){document.removeEventListener("DOMContentLoaded",e,!1),t()}),!1)}else document.attachEvent&&(a=t,r=e.document,o=!1,(c=function(){try{r.documentElement.doScroll("left")}catch(t){return void setTimeout(c,50)}n()})(),r.onreadystatechange=function(){"complete"==r.readyState&&(r.onreadystatechange=null,n())});function n(){o||(o=!0,a())}var a,r,o,c}((function(){var e,t,a,r,o,c;(e=document.createElement("div")).innerHTML=n,n=null,(t=e.getElementsByTagName("svg")[0])&&(t.setAttribute("aria-hidden","true"),t.style.position="absolute",t.style.width=0,t.style.height=0,t.style.overflow="hidden",a=t,(r=document.body).firstChild?(o=a,(c=r.firstChild).parentNode.insertBefore(o,c)):r.appendChild(a))}))}(window)},85:function(e,t,n){},87:function(e,t,n){},89:function(e,t,n){}}]);
//# sourceMappingURL=5.3f18d919.chunk.js.map